<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Modern C++ IDE for Emacs</title>
<!-- 2018-04-20 Fri 20:57 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Zuogong Yue" />
<link rel="stylesheet" type="text/css" media="all" href="https://rawgit.com/oracleyue/dotfiles/master/_emacs.d/templates/css/bootstrap.min.css" />
<link rel="stylesheet" type="text/css" media="all" href="https://rawgit.com/oracleyue/dotfiles/master/_emacs.d/templates/css/style.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Modern C++ IDE for Emacs</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Modern C++ IDE for Emacs</a>
<ul>
<li><a href="#sec-1-1">1.1. Requirements</a>
<ul>
<li><a href="#sec-1-1-1">1.1.1. install software in OS</a></li>
<li><a href="#sec-1-1-2">1.1.2. install packages in emacs</a></li>
</ul>
</li>
<li><a href="#sec-1-2">1.2. C++ Coding styles</a>
<ul>
<li><a href="#sec-1-2-1">1.2.1. Default style for C/C++</a></li>
<li><a href="#sec-1-2-2">1.2.2. Basic edit enhancement for C/C++</a>
<ul>
<li><a href="#sec-1-2-2-1">1.2.2.1. Auto insert pair of symbols using smartparens</a></li>
</ul>
</li>
<li><a href="#sec-1-2-3">1.2.3. Google C++ style and its flymake checker</a></li>
</ul>
</li>
<li><a href="#sec-1-3">1.3. Source code navigation using gtags</a></li>
<li><a href="#sec-1-4">1.4. Source code navigation using RTags</a>
<ul>
<li><a href="#sec-1-4-1">1.4.1. Install rtags servers in OS</a></li>
<li><a href="#sec-1-4-2">1.4.2. Setup rtags packages in Emacs</a>
<ul>
<li><a href="#sec-1-4-2-1">1.4.2.1. use rtags for code navigation</a></li>
<li><a href="#sec-1-4-2-2">1.4.2.2. use rtags for code completions (disabled)</a></li>
<li><a href="#sec-1-4-2-3">1.4.2.3. integration with helm</a></li>
</ul>
</li>
<li><a href="#sec-1-4-3">1.4.3. Run rtags server for projects</a></li>
<li><a href="#sec-1-4-4">1.4.4. Usages</a>
<ul>
<li><a href="#sec-1-4-4-1">1.4.4.1. Basic movements</a></li>
<li><a href="#sec-1-4-4-2">1.4.4.2. Find definitions/references in project</a></li>
<li><a href="#sec-1-4-4-3">1.4.4.3. Find files in project</a></li>
<li><a href="#sec-1-4-4-4">1.4.4.4. View visited tags with tag stack</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-1-5">1.5. Source code completion using irony</a>
<ul>
<li><a href="#sec-1-5-1">1.5.1. Prerequisites (For Mac OS X)</a></li>
<li><a href="#sec-1-5-2">1.5.2. Setup</a></li>
<li><a href="#sec-1-5-3">1.5.3. Using Company with Irony</a></li>
<li><a href="#sec-1-5-4">1.5.4. Header file completion with company-irony-c-headers</a></li>
<li><a href="#sec-1-5-5">1.5.5. Show eldoc for C/C++ mode via irony (disabled)</a></li>
<li><a href="#sec-1-5-6">1.5.6. Auto-generate .clang_complete</a></li>
</ul>
</li>
<li><a href="#sec-1-6">1.6. Syntax checking with Flycheck</a>
<ul>
<li><a href="#sec-1-6-1">1.6.1. Prerequisites</a></li>
<li><a href="#sec-1-6-2">1.6.2. Integrating RTags with Flycheck (disabled)</a></li>
<li><a href="#sec-1-6-3">1.6.3. Integrating Irony with Flycheck</a></li>
<li><a href="#sec-1-6-4">1.6.4. Keybindings</a></li>
</ul>
</li>
<li><a href="#sec-1-7">1.7. CMake automation with cmake-ide (disabled)</a>
<ul>
<li><a href="#sec-1-7-1">1.7.1. Prerequisites</a></li>
<li><a href="#sec-1-7-2">1.7.2. Using cmake-ide</a></li>
</ul>
</li>
<li><a href="#sec-1-8">1.8. More supports for C/C++ programming</a>
<ul>
<li><a href="#sec-1-8-1">1.8.1. Compilation supports for C/C++, cmake and makefile</a></li>
<li><a href="#sec-1-8-2">1.8.2. Major modes to edit CMake files</a></li>
<li><a href="#sec-1-8-3">1.8.3. Major modes for doxygen documentations (disabled)</a></li>
</ul>
</li>
<li><a href="#sec-1-9">1.9. Ends</a></li>
</ul>
</li>
</ul>
</div>
</div>



<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Modern C++ IDE for Emacs</h2>
<div class="outline-text-2" id="text-1">
<p>
Features:
</p>
<ul class="org-ul">
<li>use <b>rtags</b> for code navigation (if enable by <code>*enable-rtags*</code> in <code>init-features.el</code>)
</li>
<li>use <b>irony-mode</b>, <b>rtags</b> for code completion (use <b>company</b> as ac-engine)
</li>
<li>integrate <b>flycheck</b> with <b>rtags</b> (disabled) and <b>irony</b>
</li>
<li>use <b>cmake-ide</b> to integrate cmake-based projects
</li>
<li>use <b>helm-make</b> as alternative compilation
</li>
</ul>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Requirements</h3>
<div class="outline-text-3" id="text-1-1">
</div><div id="outline-container-sec-1-1-1" class="outline-4">
<h4 id="sec-1-1-1"><span class="section-number-4">1.1.1</span> install software in OS</h4>
<div class="outline-text-4" id="text-1-1-1">
<ol class="org-ol">
<li>use <code>pip</code> to install <code>cpplint</code> for <b>google-cpp-style</b>
</li>

<li>have <b>cmake</b> installed
</li>

<li>install <b>clang/LLVM</b>: <code>brew install llvm</code>
</li>

<li>compile <b>irony-server</b>
<ul class="org-ul">
<li>make a clean build directory
</li>
<li>run <code>cmake -DCMAKE_PREFIX_PATH=/usr/local/Cellar/llvm/5.0.0/ -DCMAKE_INSTALL_RPATH_USE_LINK_PATH=ON ~/.emacs.d/elpa/irony-20170828.1218/server/</code>
</li>
<li>build and run <code>make &amp;&amp; ./bin/irony-server --version</code>
</li>
<li>copy <code>./bin/irony-server</code> under your <code>.emacs.d/bin</code>
</li>
</ul>
</li>

<li>compile <b>rtags</b> servers (see RTags section)
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-1-1-2" class="outline-4">
<h4 id="sec-1-1-2"><span class="section-number-4">1.1.2</span> install packages in emacs</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
Adding a header for the exported <code>.el</code> file.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5C6370;">; </span><span style="color: #5C6370;">=====================================================</span>
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">Programming Environment for C/C++ (modern)</span>
<span style="color: #5C6370;">; </span><span style="color: #5C6370;">=====================================================</span>
</pre>
</div>

<p>
Install the additional packages to support the modern C/C++ environment.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">check and install essential pkgs</span>
(<span style="color: #C678DD;">setq</span> custom/modern-cc-packages
      '(irony
        company-irony
        company-irony-c-headers
        flycheck-irony
        irony-eldoc
        helm-make
        ))
(<span style="color: #C678DD;">when</span> *enable-rtags*
  (<span style="color: #C678DD;">setq</span> custom/modern-cc-packages
        (append
         '(rtags
           company-rtags
           helm-rtags
           flycheck-rtags
           cmake-ide)
         custom/modern-cc-packages)))
(<span style="color: #C678DD;">unless</span> (custom/packages-installed-p custom/modern-cc-packages)
  (package-refresh-contents)
  (<span style="color: #C678DD;">dolist</span> (pkg custom/modern-cc-packages)
    (<span style="color: #C678DD;">unless</span> (package-installed-p pkg)
      (package-install pkg))))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> C++ Coding styles</h3>
<div class="outline-text-3" id="text-1-2">
</div><div id="outline-container-sec-1-2-1" class="outline-4">
<h4 id="sec-1-2-1"><span class="section-number-4">1.2.1</span> Default style for C/C++</h4>
<div class="outline-text-4" id="text-1-2-1">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #C678DD;">require</span> '<span style="color: #56B6C2;">cc-mode</span>)
(<span style="color: #C678DD;">setq-default</span> c-default-style <span style="color: #98C379;">"linux"</span>)
(<span style="color: #C678DD;">setq-default</span> c-basic-offset 4)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-2-2" class="outline-4">
<h4 id="sec-1-2-2"><span class="section-number-4">1.2.2</span> Basic edit enhancement for C/C++</h4>
<div class="outline-text-4" id="text-1-2-2">
</div><div id="outline-container-sec-1-2-2-1" class="outline-5">
<h5 id="sec-1-2-2-1"><span class="section-number-5">1.2.2.1</span> Auto insert pair of symbols using smartparens</h5>
<div class="outline-text-5" id="text-1-2-2-1">
<p>
Install <code>smartparens</code> mode and enable it by <code>(require 'smartparens)</code>, which has been enabled in <code>.emacs</code> globally.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/smartparens/: insert pair of symbols</span>
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">when you press RET, the curly braces automatically add another newline</span>
(<span style="color: #C678DD;">sp-with-modes</span> '(c-mode c++-mode)
  (sp-local-pair <span style="color: #98C379;">"{"</span> nil <span style="color: #56B6C2;">:post-handlers</span> '((<span style="color: #98C379;">"||\n[i]"</span> <span style="color: #98C379;">"RET"</span>)))
  (sp-local-pair <span style="color: #98C379;">"/*"</span> <span style="color: #98C379;">"*/"</span> <span style="color: #56B6C2;">:post-handlers</span> '((<span style="color: #98C379;">"| "</span> <span style="color: #98C379;">"SPC"</span>) (<span style="color: #98C379;">"* ||\n[i]"</span> <span style="color: #98C379;">"RET"</span>))))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-2-3" class="outline-4">
<h4 id="sec-1-2-3"><span class="section-number-4">1.2.3</span> Google C++ style and its flymake checker</h4>
<div class="outline-text-4" id="text-1-2-3">
<p>
Install <code>google-c-style</code> and <code>flymake-google-cpplint</code>.
You also need to install Python package <code>cpplint</code> by <code>pip</code>.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/google-c-style/ and /flymake-google-cpplint/ style checker</span>
(<span style="color: #C678DD;">when</span> *enable-gg-cpp-style*
  (<span style="color: #C678DD;">require</span> '<span style="color: #56B6C2;">google-c-style</span>)
  (add-hook 'c-mode-common-hook 'google-set-c-style)
  (add-hook 'c-mode-common-hook 'google-make-newline-indent)
  (<span style="color: #C678DD;">defun</span> <span style="color: #61AFEF;">y:flymake-google-init</span> ()
    (<span style="color: #C678DD;">require</span> '<span style="color: #56B6C2;">flymake-google-cpplint</span>)
    (<span style="color: #C678DD;">setq</span> flymake-google-cpplint-command
      (<span style="color: #C678DD;">if</span> (string-equal system-type <span style="color: #98C379;">"darwin"</span>)
          <span style="color: #98C379;">"/usr/local/bin/cpplint"</span> <span style="color: #98C379;">"/usr/bin/cpplint"</span>))
    (flymake-google-cpplint-load))
  (add-hook 'c-mode-hook 'y:flymake-google-init)
  (add-hook 'c++-mode-hook 'y:flymake-google-init))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Source code navigation using gtags</h3>
<div class="outline-text-3" id="text-1-3">
<p>
See <code>init-gtags.el</code>, which also supports tag-based code navigation of other languages.
</p>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> Source code navigation using RTags</h3>
<div class="outline-text-3" id="text-1-4">
</div><div id="outline-container-sec-1-4-1" class="outline-4">
<h4 id="sec-1-4-1"><span class="section-number-4">1.4.1</span> Install rtags servers in OS</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
Build and install RTags using the RTags Quickstart Guide. Alternatively install RTags using your distribution's package manager.
</p>

<p>
For OS X (due to the issues of duplicated clang's), compile as follows:
</p>
<div class="org-src-container">

<pre class="src src-sh">git clone --recursive https://github.com/Andersbakken/rtags.git
<span style="color: #56B6C2;">cd</span> rtags
mkdir build &amp;&amp; <span style="color: #56B6C2;">cd</span> build
cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=1 -DCMAKE_PREFIX_PATH=/usr/local/Cellar/llvm/5.0.0/ ..
make
</pre>
</div>
<p>
Put <code>rdm</code> and <code>rc</code> under your PATH.
</p>
</div>
</div>

<div id="outline-container-sec-1-4-2" class="outline-4">
<h4 id="sec-1-4-2"><span class="section-number-4">1.4.2</span> Setup rtags packages in Emacs</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
Install rtags from MELPA.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #C678DD;">when</span> *enable-rtags*
  <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">see the const *enable-rtags* defined in "init-features.el"</span>
</pre>
</div>
</div>

<div id="outline-container-sec-1-4-2-1" class="outline-5">
<h5 id="sec-1-4-2-1"><span class="section-number-5">1.4.2.1</span> use rtags for code navigation</h5>
<div class="outline-text-5" id="text-1-4-2-1">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #C678DD;">require</span> '<span style="color: #56B6C2;">rtags</span>)
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">run rtags server automatically</span>
(rtags-start-process-unless-running)
(rtags-enable-standard-keybindings)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-4-2-2" class="outline-5">
<h5 id="sec-1-4-2-2"><span class="section-number-5">1.4.2.2</span> use rtags for code completions (disabled)</h5>
<div class="outline-text-5" id="text-1-4-2-2">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #C678DD;">setq</span> rtags-autostart-diagnostics t)
(<span style="color: #C678DD;">setq</span> rtags-completions-enabled t)
(<span style="color: #C678DD;">push</span> 'company-rtags company-backends)
</pre>
</div>
<p>
If want to use <b>rtags</b> as <b>company</b> backend together with <b>irony</b> at the same time, we could add <code>company-rtags</code> in the same list with <code>company-irony</code>.
</p>
</div>
</div>

<div id="outline-container-sec-1-4-2-3" class="outline-5">
<h5 id="sec-1-4-2-3"><span class="section-number-5">1.4.2.3</span> integration with helm</h5>
<div class="outline-text-5" id="text-1-4-2-3">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #C678DD;">setq</span> rtags-display-result-backend 'helm)
</pre>
</div>

<div class="org-src-container">

<pre class="src src-emacs-lisp">) <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">close the condition on *enable-rtags*</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-4-3" class="outline-4">
<h4 id="sec-1-4-3"><span class="section-number-4">1.4.3</span> Run rtags server for projects</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
Before using RTags you need to start rdm and index your project. In order to index your project, RTags requires you to export your project's compile commands with cmake.
</p>

<div class="org-src-container">

<pre class="src src-sh">$ rdm &amp;
$ cd /path/to/project/dir/containing/compile_commands.json/
$ cmake . -DCMAKE_EXPORT_COMPILE_COMMANDS=1
$ rc -J .
</pre>
</div>

<p>
We'll see how to automate this process with cmake-ide below.
</p>
</div>
</div>

<div id="outline-container-sec-1-4-4" class="outline-4">
<h4 id="sec-1-4-4"><span class="section-number-4">1.4.4</span> Usages</h4>
<div class="outline-text-4" id="text-1-4-4">
</div><div id="outline-container-sec-1-4-4-1" class="outline-5">
<h5 id="sec-1-4-4-1"><span class="section-number-5">1.4.4.1</span> Basic movements</h5>
<div class="outline-text-5" id="text-1-4-4-1">
<p>
<code>C-M-f</code> runs forward-sexp, move forward over a balanced expression that can be a pair or a symbol.
<code>C-M-b</code> runs backward-sexp, move backward over a balanced expression that can be a pair or a symbol.
<code>C-M-k</code> runs kill-sexp, kill balanced expression forward that can be a pair or a symbol.
<code>C-M-&lt;SPC&gt;</code> or <code>C-M-@</code> runs mark-sexp, put mark after following expression that can be a pair or a symbol.
<code>C-M-a</code> runs beginning-of-defun, which moves point to beginning of a function.
<code>C-M-e</code> runs end-of-defun, which moves point to end of a function.
<code>C-M-h</code> runs mark-defun, which put a region around whole current or following function.
</p>
</div>
</div>

<div id="outline-container-sec-1-4-4-2" class="outline-5">
<h5 id="sec-1-4-4-2"><span class="section-number-5">1.4.4.2</span> Find definitions/references in project</h5>
<div class="outline-text-5" id="text-1-4-4-2">
<p>
<code>C-c-r .</code> runs rtags-find-symbol-at-point, which jumps to the definition of the symbol under the cursor; press again to jump between definition and declaration.
</p>

<p>
=C-c-r ,= runs rtags-find-references-at-point, which lists all references to the symbol under the cursor.
</p>

<p>
<code>C-c-r &lt;</code> runs rtags-find-references, which prompts for the symbol name and finds all references.
<code>C-c-r &gt;</code> runs rtags-find-symbol, which prompts for symbol name and finds all references.
</p>

<p>
<code>C-c r I</code> gets a list of rtags-extracted symbols in the current file (<b>helm</b> also provides <code>helm-semantic-or-imenu</code>)
</p>
</div>
</div>

<div id="outline-container-sec-1-4-4-3" class="outline-5">
<h5 id="sec-1-4-4-3"><span class="section-number-5">1.4.4.3</span> Find files in project</h5>
<div class="outline-text-5" id="text-1-4-4-3">
<p>
<code>C-c r ;</code> runs rtags-find-file, which prompts for file name to search for out of currently indexed files.
</p>

<p>
Alternatively, this can be better accomplished with Projectile.
</p>
</div>
</div>

<div id="outline-container-sec-1-4-4-4" class="outline-5">
<h5 id="sec-1-4-4-4"><span class="section-number-5">1.4.4.4</span> View visited tags with tag stack</h5>
<div class="outline-text-5" id="text-1-4-4-4">
<p>
<code>C-c r [</code> rtags-location-stack-back Jumps to last visited tag.
<code>C-c r ]</code> rtags-location-stack-forward Moves forward in location stack.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> Source code completion using irony</h3>
<div class="outline-text-3" id="text-1-5">
</div><div id="outline-container-sec-1-5-1" class="outline-4">
<h4 id="sec-1-5-1"><span class="section-number-4">1.5.1</span> Prerequisites (For Mac OS X)</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
Download a pre-compiled package from llvm.org to install <code>irony-server</code>.
(change the 4.0.1 version with the latest (the greatest!))
</p>

<ul class="org-ul">
<li>Download <code>clang+llvm-4.0.1-x86_64-apple-darwin.tar.xz</code> from <a href="http://llvm.org/releases/download.html">http://llvm.org/releases/download.html</a>
</li>

<li>Extract it somewhere (e.g: <code>~/Programs/</code>) (Warning: you need to keep it on your computer to allow <code>irony-server</code> to work!)
</li>

<li>make a clean build directory (e.g. <code>cd ~/tmp &amp;&amp; mkdir build &amp;&amp; cd build</code>)
</li>

<li>run
</li>
</ul>
<div class="org-src-container">

<pre class="src src-sh">cmake -DCMAKE_PREFIX_PATH=/Users/oracleyue/Programs/clang+llvm-4.0.1-x86_64-apple-macosx10.9.0/ -DCMAKE_INSTALL_RPATH_USE_LINK_PATH=ON /Users/oracleyue/.emacs.d/elpa/irony-20170828.1218/server/
</pre>
</div>

<ul class="org-ul">
<li>build and run <code>make &amp;&amp; ./bin/irony-server --version</code>
</li>

<li>cp <code>irony-server</code> to your <code>.emacs.d/bin/</code>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-5-2" class="outline-4">
<h4 id="sec-1-5-2"><span class="section-number-4">1.5.2</span> Setup</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
Install irony-mode from MELPA and add the following to your emacs init file:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/irony/+/company-irony/: code completions</span>
(add-hook 'c++-mode-hook 'irony-mode)
(add-hook 'c-mode-hook 'irony-mode)
(add-hook 'irony-mode-hook 'irony-cdb-autosetup-compile-options)

(<span style="color: #C678DD;">setq</span> irony--server-executable (expand-file-name <span style="color: #98C379;">"~/.emacs.d/bin/irony-server"</span>))
(add-to-list 'irony-additional-clang-options <span style="color: #98C379;">"-std=c++11"</span>)
</pre>
</div>

<p>
NOTE: Like RTags, Irony requires a compilation database. To create one run the following:
</p>

<div class="org-src-container">

<pre class="src src-sh">$ cd /path/to/project/root
$ cmake . -DCMAKE_EXPORT_COMPILE_COMMANDS=1
</pre>
</div>

<p>
The first time you run irony you must install the <b>irony-server</b> by runing the command: <code>M-x irony-install-server</code>.
</p>
</div>
</div>

<div id="outline-container-sec-1-5-3" class="outline-4">
<h4 id="sec-1-5-3"><span class="section-number-4">1.5.3</span> Using Company with Irony</h4>
<div class="outline-text-4" id="text-1-5-3">
<p>
To use company-mode with Irony, install company-irony from melpa and add the following to your emacs init file:
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(add-hook 'irony-mode-hook 'company-irony-setup-begin-commands)
(<span style="color: #C678DD;">setq</span> company-backends (delete 'company-semantic company-backends))
</pre>
</div>
<p>
We will add the <b>irony</b> into company-backends later together with <b>irony-c-headers</b>.
</p>
</div>
</div>

<div id="outline-container-sec-1-5-4" class="outline-4">
<h4 id="sec-1-5-4"><span class="section-number-4">1.5.4</span> Header file completion with company-irony-c-headers</h4>
<div class="outline-text-4" id="text-1-5-4">
<p>
To add support for completing C++ headers:
</p>

<ul class="org-ul">
<li>Install <code>company-irony-c-headers</code> from MELPA
</li>

<li>Add the following to your emacs init file:
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #C678DD;">require</span> '<span style="color: #56B6C2;">company-irony-c-headers</span>)
(<span style="color: #C678DD;">defun</span> <span style="color: #61AFEF;">y:add-company-backend-irony</span> ()
  (<span style="color: #C678DD;">setq-local</span> company-backends
              (append '((company-irony-c-headers company-irony))
                      company-backends)))
(add-hook 'c-mode-hook 'y:add-company-backend-irony)
(add-hook 'c++-mode-hook 'y:add-company-backend-irony)
</pre>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-5-5" class="outline-4">
<h4 id="sec-1-5-5"><span class="section-number-4">1.5.5</span> Show eldoc for C/C++ mode via irony (disabled)</h4>
<div class="outline-text-4" id="text-1-5-5">
<p>
Enable the minor mode irony-eldoc, as well as eldoc-mode. For an example, place point on top of a symbol, or inside a function call.
</p>
<pre class="example">
(add-hook 'irony-mode-hook #'irony-eldoc)
</pre>
</div>
</div>

<div id="outline-container-sec-1-5-6" class="outline-4">
<h4 id="sec-1-5-6"><span class="section-number-4">1.5.6</span> Auto-generate .clang_complete</h4>
<div class="outline-text-4" id="text-1-5-6">
<p>
<code>.clang_complete</code> - A file at the root of your project containing the compilation flags, one per line.
</p>

<p>
To generate the <code>.clang_complete</code> file automatically, we use <code>cc_args.py</code>, which has a copy in your <code>~/.emacs.d/git/</code>. Copy it to the folder in your <code>PATH</code> search paths. Then, in your build folder, e.g. <code>&lt;your-project-root&gt;/build</code>,
</p>
<ul class="org-ul">
<li>run <code>CXX='cc_args.py g++' cmake ..</code>
</li>
<li>run <code>make</code> and then you find <code>.clang_complete</code> under your build folder.
</li>
<li>copy it to your project root.
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6"><span class="section-number-3">1.6</span> Syntax checking with Flycheck</h3>
<div class="outline-text-3" id="text-1-6">
</div><div id="outline-container-sec-1-6-1" class="outline-4">
<h4 id="sec-1-6-1"><span class="section-number-4">1.6.1</span> Prerequisites</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
Install <code>flycheck</code> from MELPA and add the following to your emacs init file:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/flycheck/: syntax checker</span>
(add-hook 'c++-mode-hook 'flycheck-mode)
(add-hook 'c-mode-hook 'flycheck-mode)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-6-2" class="outline-4">
<h4 id="sec-1-6-2"><span class="section-number-4">1.6.2</span> Integrating RTags with Flycheck (disabled)</h4>
<div class="outline-text-4" id="text-1-6-2">
<p>
To enable RTags and flycheck integration add the following to your emacs init file:
</p>

<pre class="example">
(require 'flycheck-rtags)

(defun y:flycheck-rtags-setup ()
  (flycheck-select-checker 'rtags)
  (setq-local flycheck-highlighting-mode nil) ;; RTags creates more accurate overlays.
  (setq-local flycheck-check-syntax-automatically nil))
(add-hook 'c-mode-common-hook #'y:flycheck-rtags-setup)
</pre>
</div>
</div>

<div id="outline-container-sec-1-6-3" class="outline-4">
<h4 id="sec-1-6-3"><span class="section-number-4">1.6.3</span> Integrating Irony with Flycheck</h4>
<div class="outline-text-4" id="text-1-6-3">
<p>
Install <code>flycheck-irony</code> from MELPA and add the following to your emacs init file:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(eval-after-load 'flycheck
  '(add-hook 'flycheck-mode-hook #'flycheck-irony-setup))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-6-4" class="outline-4">
<h4 id="sec-1-6-4"><span class="section-number-4">1.6.4</span> Keybindings</h4>
<div class="outline-text-4" id="text-1-6-4">
<ul class="org-ul">
<li><code>C-c ! n</code> and <code>C-c ! p</code>: jump to next or previous errors
</li>
<li><code>C-c ! l</code>: list errors
</li>
<li><code>C-c ! c</code>: menually run checker
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7"><span class="section-number-3">1.7</span> CMake automation with cmake-ide (disabled)</h3>
<div class="outline-text-3" id="text-1-7">
</div><div id="outline-container-sec-1-7-1" class="outline-4">
<h4 id="sec-1-7-1"><span class="section-number-4">1.7.1</span> Prerequisites</h4>
<div class="outline-text-4" id="text-1-7-1">
<p>
Install cmake-ide from MELPA and add the following to your emacs init file:
</p>
<pre class="example">
(cmake-ide-setup)
</pre>
</div>
</div>

<div id="outline-container-sec-1-7-2" class="outline-4">
<h4 id="sec-1-7-2"><span class="section-number-4">1.7.2</span> Using cmake-ide</h4>
<div class="outline-text-4" id="text-1-7-2">
<p>
To have cmake-ide automatically create a compilation commands file in your project root create a <code>.dir-locals.el</code> containing the following:
</p>
<pre class="example">
((nil . ((cmake-ide-build-dir . "&lt;PATH_TO_PROJECT_BUILD_DIRECTORY&gt;"))))
</pre>

<p>
You can now build your project using <code>M-x cmake-ide-compile</code>. Additionally, cmake-ide will automatically update your RTags index as well.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-8" class="outline-3">
<h3 id="sec-1-8"><span class="section-number-3">1.8</span> More supports for C/C++ programming</h3>
<div class="outline-text-3" id="text-1-8">
</div><div id="outline-container-sec-1-8-1" class="outline-4">
<h4 id="sec-1-8-1"><span class="section-number-4">1.8.1</span> Compilation supports for C/C++, cmake and makefile</h4>
<div class="outline-text-4" id="text-1-8-1">
<p>
Install <code>helm-make</code> package, and setup as below.
To compile the whole project, use <code>C-c p c</code> (<code>helm-make-projectile</code>); otherwise, simple run <code>M-x helm-make</code> or <code>M-x compile</code>.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">Compile commands in c/c++ and makefile modes</span>
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">use helm-make</span>
(global-set-key (kbd <span style="color: #98C379;">"C-c p c"</span>) 'helm-make-projectile)
(add-hook 'c-mode-common-hook
          (<span style="color: #C678DD;">lambda</span> () (define-key c-mode-base-map
                       (kbd <span style="color: #98C379;">"C-c C-c"</span>) 'helm-make)))
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">default mode for Makefile in gnome</span>
(add-hook 'makefile-gmake-mode-hook
          (<span style="color: #C678DD;">lambda</span> () (define-key makefile-gmake-mode-map
                       (kbd <span style="color: #98C379;">"C-c C-c"</span>) 'helm-make)))
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">default mode for Makefile in Mac OS X</span>
(add-hook 'makefile-bsdmake-mode-hook
          (<span style="color: #C678DD;">lambda</span> () (define-key makefile-bsdmake-mode-map
                       (kbd <span style="color: #98C379;">"C-c C-c"</span>) 'helm-make)))
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">compilation setup for cmake-mode</span>
(add-hook 'cmake-mode-hook
          (<span style="color: #C678DD;">lambda</span> ()
            (<span style="color: #C678DD;">setq</span> compile-command <span style="color: #98C379;">"cd build/ &amp;&amp; cmake .. &amp;&amp; make"</span>)
            (define-key cmake-mode-map (kbd <span style="color: #98C379;">"C-c C-c"</span>) 'compile)))
</pre>
</div>

<p>
If the Makefile is in different directories, e.g. created by <b>cmake</b>, we need to specify the location of <code>Makefile</code>. <code>.dir-locals.el</code> file is needed for this purpose. <code>.dir-locals.el</code> should be placed in project root. The file content looks like this:
</p>
<pre class="example">
((c++-mode (helm-make-build-dir . "build/")))
</pre>

<p>
Due to the local variable settings, Emacs will ask if the variable <code>helm-make-build-dir</code> is safe. Put the configuration in init file to prevent it.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(put 'helm-make-build-dir 'safe-local-variable 'stringp)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-8-2" class="outline-4">
<h4 id="sec-1-8-2"><span class="section-number-4">1.8.2</span> Major modes to edit CMake files</h4>
<div class="outline-text-4" id="text-1-8-2">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/cmake-mode/: cmake-mode.el</span>
(<span style="color: #C678DD;">require</span> '<span style="color: #56B6C2;">cmake-mode</span>)
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/cmake-font-lock/: to add more fontifying features</span>
(add-to-list 'load-path <span style="color: #98C379;">"~/.emacs.d/git/cmake-font-lock"</span>)
(autoload 'cmake-font-lock-activate <span style="color: #98C379;">"cmake-font-lock"</span> nil t)
(add-hook 'cmake-mode-hook 'cmake-font-lock-activate)
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">adding /company-cmake/ for ac-complete</span>
(add-to-list 'company-dabbrev-code-modes 'cmake-mode)
(<span style="color: #C678DD;">defun</span> <span style="color: #61AFEF;">y:company-cmake-setup</span> ()
  (<span style="color: #C678DD;">setq-local</span> company-backends
              (append '((company-cmake company-dabbrev-code))
                      company-backends)))
(add-hook 'cmake-mode-hook 'y:company-cmake-setup)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-8-3" class="outline-4">
<h4 id="sec-1-8-3"><span class="section-number-4">1.8.3</span> Major modes for doxygen documentations (disabled)</h4>
<div class="outline-text-4" id="text-1-8-3">
<p>
To use <code>doxymacs</code>, setup the following in your init file:
</p>

<pre class="example">
;; /doxymacs/ to manipulate doxygen documentations
(add-to-list 'load-path "~/.emacs.d/git/doxymacs-1.8.0")
(require 'doxymacs)
(add-hook 'c-mode-common-hook 'doxymacs-mode)
; fontify the doxygen keywords
(defun my-doxymacs-font-lock-hook ()
  (if (or (eq major-mode 'c-mode) (eq major-mode 'c++-mode))
      (doxymacs-font-lock)))
(add-hook 'font-lock-mode-hook 'my-doxymacs-font-lock-hook)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-9" class="outline-3">
<h3 id="sec-1-9"><span class="section-number-3">1.9</span> Ends</h3>
<div class="outline-text-3" id="text-1-9">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #C678DD;">provide</span> '<span style="color: #56B6C2;">init-cc-modern</span>)
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">================================================</span>
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">init-cc-modern.el ends here</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 20 Apr 2018</p>
<p class="author">Author: Zuogong Yue</p>
<p class="date">Created: 2018-04-20 Fri 20:57</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.3.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>