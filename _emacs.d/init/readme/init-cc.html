<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-05-03 Thu 22:27 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Modern C++ IDE for Emacs</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Zuogong Yue" />
<link rel="stylesheet" type="text/css" media="all" href="/Users/oracleyue/.emacs.d/templates/css/bootstrap.min.css" />
<link rel="stylesheet" type="text/css" media="all" href="/Users/oracleyue/.emacs.d/templates/css/style.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Modern C++ IDE for Emacs</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org01a4261">1. Modern C++ IDE for Emacs</a>
<ul>
<li><a href="#orgdae21f8">1.1. Requirements</a>
<ul>
<li><a href="#org501363f">1.1.1. install software in OS</a></li>
<li><a href="#orge46bcf4">1.1.2. install packages in emacs</a></li>
</ul>
</li>
<li><a href="#org400f355">1.2. C++ Coding styles</a>
<ul>
<li><a href="#orge506e2a">1.2.1. Default style for C/C++</a></li>
<li><a href="#org33d9e27">1.2.2. Basic edit enhancement for C/C++</a>
<ul>
<li><a href="#org8fabed5">1.2.2.1. Auto insert pair of symbols using smartparens</a></li>
</ul>
</li>
<li><a href="#orgf931da0">1.2.3. Google C++ style and its flymake checker</a></li>
</ul>
</li>
<li><a href="#org8d36b1e">1.3. Source code navigation using RTags</a>
<ul>
<li><a href="#org19247b3">1.3.1. Install rtags servers in OS</a></li>
<li><a href="#org8eb4613">1.3.2. Setup rtags packages in Emacs</a></li>
<li><a href="#orgefe790e">1.3.3. Use RTags for C/C++ projects</a></li>
<li><a href="#org193f29d">1.3.4. Usages</a>
<ul>
<li><a href="#org68aedcc">1.3.4.1. Basic movements</a></li>
<li><a href="#org330c1ce">1.3.4.2. Find definitions/references in project</a></li>
<li><a href="#org9ec3e09">1.3.4.3. Find files in project</a></li>
<li><a href="#org1ebfdd2">1.3.4.4. View visited tags with tag stack</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org4e38293">1.4. Source code completion using Irony</a>
<ul>
<li><a href="#org9779620">1.4.1. Installations</a></li>
<li><a href="#org2878673">1.4.2. Setup</a></li>
<li><a href="#orgf60648b">1.4.3. Use Irony for C/C++ projects</a></li>
<li><a href="#orgd4f4e6e">1.4.4. Integrate Irony and Irony-c-headers in Company</a></li>
<li><a href="#org9cb3938">1.4.5. [optional] Integrate Irony in Ivy</a></li>
<li><a href="#org480e9b7">1.4.6. [disabled] Show eldoc for C/C++ mode via irony</a></li>
</ul>
</li>
<li><a href="#org40a865c">1.5. Syntax checking with Flycheck</a>
<ul>
<li><a href="#org81e0bab">1.5.1. Prerequisites</a></li>
<li><a href="#org5e5073a">1.5.2. [disabled] Integrating RTags with Flycheck</a></li>
<li><a href="#orgd91d03e">1.5.3. Integrating Irony with Flycheck</a></li>
<li><a href="#orgeb9292e">1.5.4. Keybindings</a></li>
</ul>
</li>
<li><a href="#org502513a">1.6. CMake automation with cmake-ide (disabled)</a>
<ul>
<li><a href="#org1699bbc">1.6.1. Prerequisites</a></li>
<li><a href="#org8357cbe">1.6.2. Using cmake-ide</a></li>
</ul>
</li>
<li><a href="#org46e36d4">1.7. More supports for C/C++ programming</a>
<ul>
<li><a href="#orgc5074eb">1.7.1. Symbol reference tables via function-args</a></li>
<li><a href="#orgbbeb805">1.7.2. Major modes to edit CMake files</a></li>
<li><a href="#orgb216c61">1.7.3. Compilation supports via helm-make</a></li>
<li><a href="#org03db091">1.7.4. Major modes for doxygen documentations (disabled)</a></li>
</ul>
</li>
<li><a href="#org895fe5e">1.8. Ends</a></li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-org01a4261" class="outline-2">
<h2 id="org01a4261"><span class="section-number-2">1</span> Modern C++ IDE for Emacs</h2>
<div class="outline-text-2" id="text-1">
<p>
Features:
</p>
<ul class="org-ul">
<li>use <b>rtags</b> for code navigation (if enable by <code>*enable-rtags*</code> in <code>init-features.el</code>)</li>
<li>use <b>irony-mode</b>, <b>rtags</b> for code completion (use <b>company</b> as ac-engine)</li>
<li>integrate <b>flycheck</b> with <b>rtags</b> (disabled) and <b>irony</b></li>
<li>use <b>cmake-ide</b> to integrate cmake-based projects</li>
<li>use <b>helm-make</b> as alternative compilation</li>
</ul>
</div>

<div id="outline-container-orgdae21f8" class="outline-3">
<h3 id="orgdae21f8"><span class="section-number-3">1.1</span> Requirements</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org501363f" class="outline-4">
<h4 id="org501363f"><span class="section-number-4">1.1.1</span> install software in OS</h4>
<div class="outline-text-4" id="text-1-1-1">
<ol class="org-ol">
<li>use <code>pip</code> to install <code>cpplint</code> for <b>google-cpp-style</b></li>

<li>have <b>cmake</b> installed</li>

<li>install <b>clang/LLVM</b>: <code>brew install llvm</code></li>

<li>compile <b>irony-server</b>
<ul class="org-ul">
<li>make a clean build directory</li>
<li>run <code>cmake -DCMAKE_PREFIX_PATH=/usr/local/Cellar/llvm/5.0.0/ -DCMAKE_INSTALL_RPATH_USE_LINK_PATH=ON ~/.emacs.d/elpa/irony-20170828.1218/server/</code></li>
<li>build and run <code>make &amp;&amp; ./bin/irony-server --version</code></li>
<li>copy <code>./bin/irony-server</code> under your <code>.emacs.d/bin</code></li>
</ul></li>

<li>compile <b>rtags</b> servers (see RTags section)</li>
</ol>
</div>
</div>

<div id="outline-container-orge46bcf4" class="outline-4">
<h4 id="orge46bcf4"><span class="section-number-4">1.1.2</span> install packages in emacs</h4>
<div class="outline-text-4" id="text-1-1-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5C6370;">; </span><span style="color: #5C6370;">=====================================================</span>
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">Programming Environment for C/C++ (modern)</span>
<span style="color: #5C6370;">; </span><span style="color: #5C6370;">=====================================================</span>

</pre>
</div>

<p>
Install the additional packages to support the modern C/C++ environment.
Since we change to use <code>use-package</code>, the following header is no longer
needed.
</p>

<pre class="example">
;; check and install essential pkgs
(setq custom/modern-cc-packages
      '(;irony
        ;company-irony
        ;company-irony-c-headers
        ;flycheck-irony
        ;irony-eldoc
        ;cmake-ide
        ))
;; (when *enable-rtags*
;;   (setq custom/modern-cc-packages
;;         (append
;;          '(rtags
;;            company-rtags
;;            flycheck-rtags)
;;          custom/modern-cc-packages)))
(unless (custom/packages-installed-p custom/modern-cc-packages)
  (package-refresh-contents)
  (dolist (pkg custom/modern-cc-packages)
    (unless (package-installed-p pkg)
      (package-install pkg))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org400f355" class="outline-3">
<h3 id="org400f355"><span class="section-number-3">1.2</span> C++ Coding styles</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-orge506e2a" class="outline-4">
<h4 id="orge506e2a"><span class="section-number-4">1.2.1</span> Default style for C/C++</h4>
<div class="outline-text-4" id="text-1-2-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #C678DD;">require</span> '<span style="color: #56B6C2;">cc-mode</span>)
(<span style="color: #C678DD;">setq-default</span> c-default-style <span style="color: #98C379;">"linux"</span>)
(<span style="color: #C678DD;">setq-default</span> c-basic-offset 4)
</pre>
</div>
</div>
</div>

<div id="outline-container-org33d9e27" class="outline-4">
<h4 id="org33d9e27"><span class="section-number-4">1.2.2</span> Basic edit enhancement for C/C++</h4>
<div class="outline-text-4" id="text-1-2-2">
</div>
<div id="outline-container-org8fabed5" class="outline-5">
<h5 id="org8fabed5"><span class="section-number-5">1.2.2.1</span> Auto insert pair of symbols using smartparens</h5>
<div class="outline-text-5" id="text-1-2-2-1">
<p>
Install <code>smartparens</code> mode and enable it by <code>(require 'smartparens)</code>, which has been enabled in <code>.emacs</code> globally.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/smartparens/: insert pair of symbols</span>
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">when you press RET, the curly braces automatically add another newline</span>
(<span style="color: #C678DD;">sp-with-modes</span> '(c-mode c++-mode)
  (sp-local-pair <span style="color: #98C379;">"{"</span> nil <span style="color: #56B6C2;">:post-handlers</span> '((<span style="color: #98C379;">"||\n[i]"</span> <span style="color: #98C379;">"RET"</span>)))
  (sp-local-pair <span style="color: #98C379;">"/*"</span> <span style="color: #98C379;">"*/"</span> <span style="color: #56B6C2;">:post-handlers</span> '((<span style="color: #98C379;">"| "</span> <span style="color: #98C379;">"SPC"</span>) (<span style="color: #98C379;">"* ||\n[i]"</span> <span style="color: #98C379;">"RET"</span>))))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf931da0" class="outline-4">
<h4 id="orgf931da0"><span class="section-number-4">1.2.3</span> Google C++ style and its flymake checker</h4>
<div class="outline-text-4" id="text-1-2-3">
<p>
Install <code>google-c-style</code> and <code>flymake-google-cpplint</code>.
You also need to install Python package <code>cpplint</code> by <code>pip</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/google-c-style/ and /flymake-google-cpplint/ style checker</span>
(<span style="color: #C678DD;">when</span> *enable-gg-cpp-style*
  (<span style="color: #C678DD;">require</span> '<span style="color: #56B6C2;">google-c-style</span>)
  (add-hook 'c-mode-common-hook 'google-set-c-style)
  (add-hook 'c-mode-common-hook 'google-make-newline-indent)
  (<span style="color: #C678DD;">defun</span> <span style="color: #61AFEF;">y:flymake-google-init</span> ()
    (<span style="color: #C678DD;">require</span> '<span style="color: #56B6C2;">flymake-google-cpplint</span>)
    (<span style="color: #C678DD;">setq</span> flymake-google-cpplint-command
      (<span style="color: #C678DD;">if</span> (string-equal system-type <span style="color: #98C379;">"darwin"</span>)
          <span style="color: #98C379;">"/usr/local/bin/cpplint"</span> <span style="color: #98C379;">"/usr/bin/cpplint"</span>))
    (flymake-google-cpplint-load))
  (add-hook 'c-mode-hook 'y:flymake-google-init)
  (add-hook 'c++-mode-hook 'y:flymake-google-init))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org8d36b1e" class="outline-3">
<h3 id="org8d36b1e"><span class="section-number-3">1.3</span> Source code navigation using RTags</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-org19247b3" class="outline-4">
<h4 id="org19247b3"><span class="section-number-4">1.3.1</span> Install rtags servers in OS</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
Build and install RTags using the RTags Quickstart Guide. Alternatively install RTags using your distribution's package manager.
</p>

<p>
For OS X (due to the issues of duplicated clang's), compile as follows:
</p>
<div class="org-src-container">
<pre class="src src-sh">git clone --recursive https://github.com/Andersbakken/rtags.git
<span style="color: #56B6C2;">cd</span> rtags
mkdir build &amp;&amp; <span style="color: #56B6C2;">cd</span> build
cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=1 -DCMAKE_PREFIX_PATH=/usr/local/Cellar/llvm/5.0.0/ ..
make
</pre>
</div>
<p>
Put <code>rdm</code> and <code>rc</code> under your PATH.
</p>
</div>
</div>

<div id="outline-container-org8eb4613" class="outline-4">
<h4 id="org8eb4613"><span class="section-number-4">1.3.2</span> Setup rtags packages in Emacs</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
We could use RTags for code navigation and code completions in C/C++
projects. However, one may easily find its deficiency on code completion. Thus
we use Irony-mode for code completion.
</p>

<p>
If you also want to use RTags for code completion, we could add <code>company-rtags</code>
to the <code>company-backends</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #C678DD;">when</span> *enable-rtags*
  <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">see the const *enable-rtags* defined in "init-features.el"</span>
  (<span style="color: #C678DD;">use-package</span> <span style="color: #56B6C2;">rtags</span>
    <span style="color: #56B6C2;">:config</span>
    <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">run rtags server automatically</span>
    (rtags-start-process-unless-running)
    (rtags-enable-standard-keybindings)
    <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">use rtags for code completions (not recommended)</span>
    <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">(setq rtags-autostart-diagnostics t)</span>
    <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">(setq rtags-completions-enabled t)</span>
    <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">(use-package company-rtags</span>
    <span style="color: #5C6370;">;;   </span><span style="color: #5C6370;">:config</span>
    <span style="color: #5C6370;">;;   </span><span style="color: #5C6370;">(push 'company-rtags company-backends))</span>
    <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">integration with helm</span>
    (<span style="color: #C678DD;">when</span> *use-helm*
      (<span style="color: #C678DD;">setq</span> rtags-display-result-backend 'helm))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgefe790e" class="outline-4">
<h4 id="orgefe790e"><span class="section-number-4">1.3.3</span> Use RTags for C/C++ projects</h4>
<div class="outline-text-4" id="text-1-3-3">
<p>
To use RTags for CMake-based projects, I just create a <code>makefile</code>
in the project root:
</p>

<div class="org-src-container">
<pre class="src src-sh">cmake:
    <span style="color: #56B6C2;">cd</span> ./build &amp;&amp; cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=1 ..
</pre>
</div>

<p>
The <code>-DCMAKE_EXPORT_COMPILE_COMMANDS=1</code> makes <code>compile_commands.json</code> to be
emitted during the actual compilation. This file describes the compilation flags
for every source file. These flags are essential in helping the parser
understand what's going on.
</p>

<p>
To use RTags we need to start <code>rdm</code> and index your project.  In the build
directory I start
</p>

<div class="org-src-container">
<pre class="src src-sh">rdm &amp; rc -J .
</pre>
</div>

<p>
For other C++ projects which aren't CMake-based, use the excellent tool <code>bear</code>
to emit the <code>compile_commands.json</code> file. It's as easy as:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ make clean
$ bear make
</pre>
</div>
</div>
</div>

<div id="outline-container-org193f29d" class="outline-4">
<h4 id="org193f29d"><span class="section-number-4">1.3.4</span> Usages</h4>
<div class="outline-text-4" id="text-1-3-4">
</div>
<div id="outline-container-org68aedcc" class="outline-5">
<h5 id="org68aedcc"><span class="section-number-5">1.3.4.1</span> Basic movements</h5>
<div class="outline-text-5" id="text-1-3-4-1">
<p>
<code>C-M-f</code> runs forward-sexp, move forward over a balanced expression that can be a pair or a symbol.
<code>C-M-b</code> runs backward-sexp, move backward over a balanced expression that can be a pair or a symbol.
<code>C-M-k</code> runs kill-sexp, kill balanced expression forward that can be a pair or a symbol.
<code>C-M-&lt;SPC&gt;</code> or <code>C-M-@</code> runs mark-sexp, put mark after following expression that can be a pair or a symbol.
<code>C-M-a</code> runs beginning-of-defun, which moves point to beginning of a function.
<code>C-M-e</code> runs end-of-defun, which moves point to end of a function.
<code>C-M-h</code> runs mark-defun, which put a region around whole current or following function.
</p>
</div>
</div>

<div id="outline-container-org330c1ce" class="outline-5">
<h5 id="org330c1ce"><span class="section-number-5">1.3.4.2</span> Find definitions/references in project</h5>
<div class="outline-text-5" id="text-1-3-4-2">
<p>
<code>C-c-r .</code> runs rtags-find-symbol-at-point, which jumps to the definition of the symbol under the cursor; press again to jump between definition and declaration.
</p>

<p>
<code>C-c-r ,</code> runs rtags-find-references-at-point, which lists all references to the symbol under the cursor.
</p>

<p>
<code>C-c-r &lt;</code> runs rtags-find-references, which prompts for the symbol name and finds all references.
<code>C-c-r &gt;</code> runs rtags-find-symbol, which prompts for symbol name and finds all references.
</p>

<p>
<code>C-c r I</code> gets a list of rtags-extracted symbols in the current file (<b>helm</b> also provides <code>helm-semantic-or-imenu</code>)
</p>
</div>
</div>

<div id="outline-container-org9ec3e09" class="outline-5">
<h5 id="org9ec3e09"><span class="section-number-5">1.3.4.3</span> Find files in project</h5>
<div class="outline-text-5" id="text-1-3-4-3">
<p>
<code>C-c r ;</code> runs rtags-find-file, which prompts for file name to search for out of currently indexed files.
</p>

<p>
Alternatively, this can be better accomplished with Projectile.
</p>
</div>
</div>

<div id="outline-container-org1ebfdd2" class="outline-5">
<h5 id="org1ebfdd2"><span class="section-number-5">1.3.4.4</span> View visited tags with tag stack</h5>
<div class="outline-text-5" id="text-1-3-4-4">
<p>
<code>C-c r [</code> rtags-location-stack-back Jumps to last visited tag.
<code>C-c r ]</code> rtags-location-stack-forward Moves forward in location stack.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org4e38293" class="outline-3">
<h3 id="org4e38293"><span class="section-number-3">1.4</span> Source code completion using Irony</h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-org9779620" class="outline-4">
<h4 id="org9779620"><span class="section-number-4">1.4.1</span> Installations</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
<b>Mac OS X</b>:
</p>

<p>
Download a pre-compiled package from llvm.org to install <code>irony-server</code>.
(change the 4.0.1 version with the latest (the greatest!))
</p>

<ul class="org-ul">
<li>Download <code>clang+llvm-4.0.1-x86_64-apple-darwin.tar.xz</code> from <a href="http://llvm.org/releases/download.html">http://llvm.org/releases/download.html</a></li>

<li>Extract it somewhere (e.g: <code>~/Programs/</code>) (Warning: you need to keep it on your computer to allow <code>irony-server</code> to work!)</li>

<li>make a clean build directory (e.g. <code>cd ~/tmp &amp;&amp; mkdir build &amp;&amp; cd build</code>)</li>

<li>run</li>
</ul>
<div class="org-src-container">
<pre class="src src-sh">cmake -DCMAKE_PREFIX_PATH=/Users/oracleyue/Programs/clang+llvm-4.0.1-x86_64-apple-macosx10.9.0/ -DCMAKE_INSTALL_RPATH_USE_LINK_PATH=ON /Users/oracleyue/.emacs.d/elpa/irony-20170828.1218/server/
</pre>
</div>

<ul class="org-ul">
<li>build and run <code>make &amp;&amp; ./bin/irony-server --version</code></li>

<li>cp <code>irony-server</code> to your <code>.emacs.d/bin/</code></li>
</ul>


<p>
<b>Linux</b>:
</p>

<p>
The first time you must install the <code>irony-server</code> by runing the command: <code>M-x
irony-install-server</code>. You may need to re-run it when you <code>libclang</code> get
updated.
</p>
</div>
</div>

<div id="outline-container-org2878673" class="outline-4">
<h4 id="org2878673"><span class="section-number-4">1.4.2</span> Setup</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
Install irony-mode from MELPA and add the following to your emacs init file:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/irony/+/company-irony/: code completions</span>
(<span style="color: #C678DD;">use-package</span> <span style="color: #56B6C2;">irony</span>
  <span style="color: #56B6C2;">:bind</span> (<span style="color: #56B6C2;">:map</span> irony-mode-map
              (<span style="color: #98C379;">"C-c C-b"</span> . irony-cdb-menu)
              (<span style="color: #98C379;">"C-c ="</span> . irony-get-type))
  <span style="color: #56B6C2;">:after</span> cc-mode
  <span style="color: #56B6C2;">:config</span>
  (<span style="color: #C678DD;">setq</span> irony--server-executable (expand-file-name
                                    <span style="color: #98C379;">"~/.emacs.d/bin/irony-server"</span>))
  (add-to-list 'irony-additional-clang-options <span style="color: #98C379;">"-std=c++11"</span>)
  (add-hook 'c++-mode-hook 'irony-mode)
  (add-hook 'c-mode-hook 'irony-mode)
  (add-hook 'irony-mode-hook 'irony-cdb-autosetup-compile-options))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf60648b" class="outline-4">
<h4 id="orgf60648b"><span class="section-number-4">1.4.3</span> Use Irony for C/C++ projects</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
Like RTags, Irony requires a compilation database. To create one, if using
<code>cmake</code>, run the following:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cd /path/to/project/build/
$ cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=1 ..
</pre>
</div>

<p>
For other C++ projects which aren't CMake-based, use the excellent tool <code>bear</code>
to emit the <code>compile_commands.json</code> file. It's as easy as:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ make clean
$ bear make
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd4f4e6e" class="outline-4">
<h4 id="orgd4f4e6e"><span class="section-number-4">1.4.4</span> Integrate Irony and Irony-c-headers in Company</h4>
<div class="outline-text-4" id="text-1-4-4">
<p>
To integrate company-mode with Irony and add supports for C++ headers completion,
we use <code>company-irony</code> and <code>company-irony-c-headers</code> from melpa.
Put the following to your emacs init file:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #C678DD;">use-package</span> <span style="color: #56B6C2;">company-irony</span>
  <span style="color: #56B6C2;">:config</span>
  (add-hook 'irony-mode-hook 'company-irony-setup-begin-commands)
  (<span style="color: #C678DD;">setq</span> company-backends (delete 'company-semantic company-backends))

  (<span style="color: #C678DD;">use-package</span> <span style="color: #56B6C2;">company-irony-c-headers</span>
    <span style="color: #56B6C2;">:config</span>
    (eval-after-load 'company
      '(add-to-list
        'company-backends '(company-irony-c-headers company-irony)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9cb3938" class="outline-4">
<h4 id="org9cb3938"><span class="section-number-4">1.4.5</span> [optional] Integrate Irony in Ivy</h4>
<div class="outline-text-4" id="text-1-4-5">
<p>
We could also use <code>ivy/counsel</code> for completions for Irony, if you prefer Emacs's
default <code>complete-symbol</code> or <code>completion-at-point</code> to <code>company-mode</code>.
</p>

<p>
(buggy, not working well)
</p>
<pre class="example">
(defun add-ivy-irony-mode-hook ()
  (define-key irony-mode-map
    [remap completion-at-point] 'counsel-irony)
  (define-key irony-mode-map
    [remap complete-symbol] 'counsel-irony))
(add-hook 'irony-mode-hook 'add-ivy-irony-mode-hook)
(add-hook 'irony-mode-hook 'irony-cdb-autosetup-compile-options)
</pre>
</div>
</div>

<div id="outline-container-org480e9b7" class="outline-4">
<h4 id="org480e9b7"><span class="section-number-4">1.4.6</span> [disabled] Show eldoc for C/C++ mode via irony</h4>
<div class="outline-text-4" id="text-1-4-6">
<p>
Enable the minor mode <code>irony-eldoc</code>, as well as eldoc-mode. For an example,
place point on top of a symbol, or inside a function call.
</p>

<pre class="example">
(add-hook 'irony-mode-hook #'irony-eldoc)
</pre>
</div>
</div>
</div>

<div id="outline-container-org40a865c" class="outline-3">
<h3 id="org40a865c"><span class="section-number-3">1.5</span> Syntax checking with Flycheck</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-org81e0bab" class="outline-4">
<h4 id="org81e0bab"><span class="section-number-4">1.5.1</span> Prerequisites</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
Install <code>flycheck</code> from MELPA and add the following to your emacs init file:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/flycheck/: syntax checker</span>
(<span style="color: #C678DD;">use-package</span> <span style="color: #56B6C2;">flycheck</span>
  <span style="color: #56B6C2;">:config</span>
  (add-hook 'c++-mode-hook 'flycheck-mode)
  (add-hook 'c-mode-hook 'flycheck-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5e5073a" class="outline-4">
<h4 id="org5e5073a"><span class="section-number-4">1.5.2</span> [disabled] Integrating RTags with Flycheck</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
To enable RTags and flycheck integration add the following to your emacs init
file:
</p>

<pre class="example">
(use-package flycheck-rtags
  :config
  (defun y:flycheck-rtags-setup ()
    (flycheck-select-checker 'rtags)
    ;; RTags creates more accurate overlays.
    (setq-local flycheck-highlighting-mode nil)
    (setq-local flycheck-check-syntax-automatically nil))
  (add-hook 'c-mode-common-hook #'y:flycheck-rtags-setup))
</pre>
</div>
</div>

<div id="outline-container-orgd91d03e" class="outline-4">
<h4 id="orgd91d03e"><span class="section-number-4">1.5.3</span> Integrating Irony with Flycheck</h4>
<div class="outline-text-4" id="text-1-5-3">
<p>
We use <code>flycheck-irony</code> from MELPA to perform syntax checking via <code>irony</code>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/flycheck-irony/ using /irony/</span>
(<span style="color: #C678DD;">use-package</span> <span style="color: #56B6C2;">flycheck-irony</span>
  <span style="color: #56B6C2;">:requires</span> flycheck
  <span style="color: #56B6C2;">:config</span>
  (eval-after-load 'flycheck
    '(add-hook 'flycheck-mode-hook #'flycheck-irony-setup)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgeb9292e" class="outline-4">
<h4 id="orgeb9292e"><span class="section-number-4">1.5.4</span> Keybindings</h4>
<div class="outline-text-4" id="text-1-5-4">
<ul class="org-ul">
<li><code>C-c ! n</code> and <code>C-c ! p</code>: jump to next or previous errors</li>
<li><code>C-c ! l</code>: list errors</li>
<li><code>C-c ! c</code>: menually run checker</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org502513a" class="outline-3">
<h3 id="org502513a"><span class="section-number-3">1.6</span> CMake automation with cmake-ide (disabled)</h3>
<div class="outline-text-3" id="text-1-6">
</div>
<div id="outline-container-org1699bbc" class="outline-4">
<h4 id="org1699bbc"><span class="section-number-4">1.6.1</span> Prerequisites</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
Install cmake-ide from MELPA and add the following to your emacs init file:
</p>
<pre class="example">
(use-package cmake-ide
  :config
  (cmake-ide-setup))
</pre>
</div>
</div>

<div id="outline-container-org8357cbe" class="outline-4">
<h4 id="org8357cbe"><span class="section-number-4">1.6.2</span> Using cmake-ide</h4>
<div class="outline-text-4" id="text-1-6-2">
<p>
To have cmake-ide automatically create a compilation commands file in your project root create a <code>.dir-locals.el</code> containing the following:
</p>
<pre class="example">
((nil . ((cmake-ide-build-dir . "&lt;PATH_TO_PROJECT_BUILD_DIRECTORY&gt;"))))
</pre>

<p>
You can now build your project using <code>M-x cmake-ide-compile</code>. Additionally, cmake-ide will automatically update your RTags index as well.
</p>
</div>
</div>
</div>

<div id="outline-container-org46e36d4" class="outline-3">
<h3 id="org46e36d4"><span class="section-number-3">1.7</span> More supports for C/C++ programming</h3>
<div class="outline-text-3" id="text-1-7">
</div>
<div id="outline-container-orgc5074eb" class="outline-4">
<h4 id="orgc5074eb"><span class="section-number-4">1.7.1</span> Symbol reference tables via function-args</h4>
<div class="outline-text-4" id="text-1-7-1">
<p>
<code>function-args</code> showing an inline arguments hint for the C/C++ function at
point. We particularly use the following two functions: <code>moo-jump-local</code> and
<code>moo-jump-directory</code>, which show a summary/table of C/C++ symbols.
</p>

<p>
(See <a href="https://github.com/abo-abo/function-args">https://github.com/abo-abo/function-args</a> for more features. However, I
personally do not use them.)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/function-args/: C/C++ symbol reference tables</span>
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">usages:</span>
<span style="color: #5C6370;">;;   </span><span style="color: #5C6370;">=moo-jump-local= "C-M-j", =moo-jump-directory= "C-M-k"</span>
(<span style="color: #C678DD;">when</span> (<span style="color: #C678DD;">and</span> *enable-function-args* *enable-semantics*)
  (<span style="color: #C678DD;">use-package</span> <span style="color: #56B6C2;">function-args</span>
    <span style="color: #56B6C2;">:requires</span> ivy
    <span style="color: #56B6C2;">:config</span>
    <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">enable case-insensitive searching</span>
    (set-default 'semantic-case-fold t)
    <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">set selection interface</span>
    (<span style="color: #C678DD;">if</span> *use-helm*
        (<span style="color: #C678DD;">setq</span> moo-select-method 'helm)  <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">ivy, helm, helm-fuzzy</span>
      (<span style="color: #C678DD;">setq</span> moo-select-method 'ivy))
    <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">enable function-args</span>
    (add-hook 'c-mode-hook 'fa-config-default)
    (add-hook 'c++-mode-hook 'fa-config-default)
    <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">semantic refresh: "M-x semantic-force-refresh"</span>
    <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">restore default keybindings</span>
    <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">"M-u": fa-abort; "M-o": moo-complete</span>
    (define-key function-args-mode-map (kbd <span style="color: #98C379;">"M-u"</span>) 'upcase-word)
    (define-key function-args-mode-map (kbd <span style="color: #98C379;">"M-o"</span>) 'open-previous-line)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbbeb805" class="outline-4">
<h4 id="orgbbeb805"><span class="section-number-4">1.7.2</span> Major modes to edit CMake files</h4>
<div class="outline-text-4" id="text-1-7-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #C678DD;">use-package</span> <span style="color: #56B6C2;">cmake-mode</span>
  <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/cmake-mode/: cmake-mode.el</span>
  <span style="color: #56B6C2;">:load-path</span> <span style="color: #98C379;">"~/.emacs.d/git/"</span>
  <span style="color: #56B6C2;">:config</span>
  <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">/cmake-font-lock/: to add more fontifying features</span>
  (<span style="color: #C678DD;">use-package</span> <span style="color: #56B6C2;">cmake-font-lock</span>
    <span style="color: #56B6C2;">:load-path</span> <span style="color: #98C379;">"~/.emacs.d/git/cmake-font-lock"</span>
    <span style="color: #56B6C2;">:config</span>
    (autoload 'cmake-font-lock-activate <span style="color: #98C379;">"cmake-font-lock"</span> nil t)
    (add-hook 'cmake-mode-hook 'cmake-font-lock-activate))
  <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">adding /company-cmake/ for ac-complete</span>
  (add-to-list 'company-dabbrev-code-modes 'cmake-mode)
  (<span style="color: #C678DD;">defun</span> <span style="color: #61AFEF;">y:company-cmake-setup</span> ()
    (<span style="color: #C678DD;">setq-local</span> company-backends
                (append '((company-cmake company-dabbrev-code))
                        company-backends)))
  (add-hook 'cmake-mode-hook 'y:company-cmake-setup)
  <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">compilation setup for cmake-mode</span>
  (add-hook 'cmake-mode-hook
            (<span style="color: #C678DD;">lambda</span> ()
              (<span style="color: #C678DD;">setq</span> compile-command <span style="color: #98C379;">"cd build/ &amp;&amp; cmake .. &amp;&amp; make"</span>)
              (define-key cmake-mode-map (kbd <span style="color: #98C379;">"C-c C-c"</span>) 'compile))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb216c61" class="outline-4">
<h4 id="orgb216c61"><span class="section-number-4">1.7.3</span> Compilation supports via helm-make</h4>
<div class="outline-text-4" id="text-1-7-3">
<p>
One may use <code>helm-make</code> package to run makefile.  To compile the whole project,
use <code>C-c p c</code> (<code>helm-make-projectile</code>); otherwise, simple run <code>M-x helm-make</code> or
<code>M-x compile</code>.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #5C6370;">;; </span><span style="color: #5C6370;">Compile commands in c/c++ and makefile modes using helm-make</span>
(<span style="color: #C678DD;">use-package</span> <span style="color: #56B6C2;">helm-make</span>
  <span style="color: #56B6C2;">:bind</span> ((<span style="color: #98C379;">"C-c p c"</span> . helm-make-projectile)
         <span style="color: #56B6C2;">:map</span> c-mode-base-map
         (<span style="color: #98C379;">"C-c C-c"</span> . helm-make)
         <span style="color: #56B6C2;">:map</span> makefile-gmake-mode-map   <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">makefile in Linux</span>
         (<span style="color: #98C379;">"C-c C-c"</span> . helm-make)
         <span style="color: #56B6C2;">:map</span> makefile-bsdmake-mode-map <span style="color: #5C6370;">;; </span><span style="color: #5C6370;">makefile in BSD</span>
         (<span style="color: #98C379;">"C-c C-c"</span> . helm-make)))
</pre>
</div>

<p>
If the Makefile is in different directories, e.g. created by <b>cmake</b>, we need to
specify the location of <code>Makefile</code>. <code>.dir-locals.el</code> file is needed for this
purpose. <code>.dir-locals.el</code> should be placed in project root. The file content
looks like this:
</p>

<pre class="example">
((c++-mode (helm-make-build-dir . "build/")))
</pre>
<p>
Due to the local variable settings, Emacs will ask if the variable <code>helm-make-build-dir</code> is safe. Put the configuration in init file to prevent it.
</p>
<pre class="example">
(put 'helm-make-build-dir 'safe-local-variable 'stringp)
</pre>
</div>
</div>

<div id="outline-container-org03db091" class="outline-4">
<h4 id="org03db091"><span class="section-number-4">1.7.4</span> Major modes for doxygen documentations (disabled)</h4>
<div class="outline-text-4" id="text-1-7-4">
<p>
To use <code>doxymacs</code>, setup the following in your init file:
</p>

<pre class="example">
;; /doxymacs/ to manipulate doxygen documentations
(add-to-list 'load-path "~/.emacs.d/git/doxymacs-1.8.0")
(require 'doxymacs)
(add-hook 'c-mode-common-hook 'doxymacs-mode)
; fontify the doxygen keywords
(defun my-doxymacs-font-lock-hook ()
  (if (or (eq major-mode 'c-mode) (eq major-mode 'c++-mode))
      (doxymacs-font-lock)))
(add-hook 'font-lock-mode-hook 'my-doxymacs-font-lock-hook)
</pre>
</div>
</div>
</div>

<div id="outline-container-org895fe5e" class="outline-3">
<h3 id="org895fe5e"><span class="section-number-3">1.8</span> Ends</h3>
<div class="outline-text-3" id="text-1-8">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #C678DD;">provide</span> '<span style="color: #56B6C2;">init-cc</span>)
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">================================================</span>
<span style="color: #5C6370;">;; </span><span style="color: #5C6370;">init-cc.el ends here</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 20 Apr 2018</p>
<p class="author">Author: Zuogong Yue</p>
<p class="date">Created: 2018-05-03 Thu 22:27</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>