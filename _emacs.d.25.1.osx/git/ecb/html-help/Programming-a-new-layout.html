<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 5.2, http://www.gnu.org/software/texinfo/ -->
<head>
<title>ECB - the Emacs Code Browser: Programming a new layout</title>

<meta name="description" content="ECB - the Emacs Code Browser: Programming a new layout">
<meta name="keywords" content="ECB - the Emacs Code Browser: Programming a new layout">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="ecb.html#Top" rel="start" title="Top">
<link href="Command-Index.html#Command-Index" rel="index" title="Command Index">
<link href="Concept-Index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="The-layout_002dengine.html#The-layout_002dengine" rel="up" title="The layout-engine">
<link href="Programming-special-windows.html#Programming-special-windows" rel="next" title="Programming special windows">
<link href="The-layout_002dengine.html#The-layout_002dengine" rel="prev" title="The layout-engine">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.indentedblock {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
div.smalllisp {margin-left: 3.2em}
kbd {font-style:oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nocodebreak {white-space:nowrap}
span.nolinebreak {white-space:nowrap}
span.roman {font-family:serif; font-weight:normal}
span.sansserif {font-family:sans-serif; font-weight:normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">
<a name="Programming-a-new-layout"></a>
<div class="header">
<p>
Next: <a href="Programming-special-windows.html#Programming-special-windows" accesskey="n" rel="next">Programming special windows</a>, Previous: <a href="The-layout_002dengine.html#The-layout_002dengine" accesskey="p" rel="prev">The layout-engine</a>, Up: <a href="The-layout_002dengine.html#The-layout_002dengine" accesskey="u" rel="up">The layout-engine</a> &nbsp; [<a href="Concept-Index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Command-Index.html#Command-Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="How-to-program-a-new-layout"></a>
<h4 class="subsection">11.5.1 How to program a new layout</h4>

<p>If you just want creating a new layout with the standard ECB-windows
like directories, sources, methods, history and speedbar it&rsquo;s is
strongly recommended to define the new layout interactively with the
command <code>ecb-create-new-layout</code> (see <a href="Creating-a-new-ECB_002dlayout.html#Creating-a-new-ECB_002dlayout">Creating a new ECB-layout</a>).
</p>
<p>If you want creating a new layout and if this layout should contain
other special windows than the standard ECB-windows then it&rsquo;s still
recommended to define this layout interactively with
<code>ecb-create-new-layout</code> and using the option to give the created
windows user-defined types. For every user defined type you have then
just to program the necessary buffer-set function. For all the details
see <a href="Creating-a-new-ECB_002dlayout.html#Creating-a-new-ECB_002dlayout">Creating a new ECB-layout</a>.
</p>
<p>But if you do not like the interactive way (because you are tough and
brave) but you want programming the new layout with Elisp then use the
macro <code>ecb-layout-define</code> (the following definition has stripped
the prefix &ldquo;ecb-&rdquo; for better indexing this manual):
</p>
<dl>
<dt><a name="index-layout_002ddefine"></a>Macro: <strong>layout-define</strong> <em>name type doc &amp;rest create-code</em></dt>
<dd><p>Creates a new ECB-layout with name <var>NAME</var>. <var>TYPE</var> is the type
of the new layout and is literal, i.e. not evaluated. It can be left,
right, top or left-right. <var>DOC</var> is the docstring for the new
layout-function &ldquo;ecb-layout-function-&lt;name&gt;&rdquo;. <var>CREATE-CODE</var> is
all the lisp code which is necessary to define the
ECB-windows/buffers. This macro adds the layout with <var>NAME</var> and
<var>TYPE</var>to the internal variable <code>ecb-available-layouts</code>.
</p>
<p>Preconditions for <var>CREATE-CODE</var>:
</p><ol>
<li> Current frame is splitted at least in one edit-window and the
&ldquo;column&rdquo; (for layout types left, right and left-right) rsp. &ldquo;row&rdquo;
(for a top layout) for the special ECB-windows/buffers. The width of
the &ldquo;column&rdquo; rsp. the height of the &ldquo;row&rdquo; is always defined with
the option <code>ecb-windows-width</code> rsp. <code>ecb-windows-height</code>.
Depending on the value of the option <code>ecb-compile-window-height</code>
there is also a compile window at the bottom of the frame which is
stored in <code>ecb-compile-window</code>.

</li><li> All windows are not dedicated.

</li><li> Neither the edit-window nor the compile-window (if there is one) are
selected for types left, right and top. For type left-right the left
column-window is selected

</li><li> All ECB-advices of the advice-sets <code>ecb-basic-adviced-functions</code>
and <code>ecb-permanent-adviced-functions</code> are disabled.
</li></ol>

<p>Things <var>CREATE-CODE</var> has to do:
</p><ol>
<li> Splitting the ECB-tree-windows-column(s)/row (s.a.) in all the
ECB-windows the layout should contain (directories, sources, methods
and history). The split must not be done with other functions than
<code>ecb-split-hor</code> and <code>ecb-split-ver</code>! It is recommended not to
to use a &ldquo;hard&rdquo; number of split-lines or -rows but using fractions
between -0.9 and +0.9! Tip: It is recommended to spilt from right to
left and from bottom to top or with other words: First create the
right-most and bottom-most special windows!

</li><li> Making each special ECB-window a dedicated window. This can be done with
one of the following functions:
<ul class="no-bullet">
<li>- <code>ecb-set-directories-buffer</code>
</li><li>- <code>ecb-set-sources-buffer</code>
</li><li>- <code>ecb-set-methods-buffer</code>
</li><li>- <code>ecb-set-history-buffer</code>
</li><li>- <code>ecb-set-speedbar-buffer</code>
</li><li>- <code>ecb-set-analyse-buffer</code>
</li><li>- <code>ecb-set-symboldef-buffer</code>
</li></ul>
<p>Each layout can only contain one of each tree-buffer-type!
</p>
<p>In addition to these functions there is a general macro:
<code>defecb-window-dedicator-to-ecb-buffer</code>: This macro defines a so called
&ldquo;window-dedicator&rdquo; which is a function registered at ECB and called by ECB
to perform any arbitrary code in current window and makes the window autom.
dedicated to the special ecb-buffer at the end. This can be used by third
party packages like JDEE to create arbitrary ECB-windows besides the standard
special ecb-windows.
</p>
<p>To make a special ECB-window a dedicated window either one of the seven
functions above must be used or a new &ldquo;window-dedicator&rdquo;-function
has to be defined with <code>defecb-window-dedicator-to-ecb-buffer</code> and must be used
within the layout-definition.
</p>
</li><li> Every(!) special ECB-window must be dedicated to a buffer as described in 2.

</li><li> <var>CREATE-CODE</var> must work correctly regardless if there is already a
compile-window (stored in <code>ecb-compile-window</code>) or not
(<code>ecb-compile-window</code> is nil).
</li></ol>

<p>Things <var>CREATE-CODE</var> can do or can use:
</p><ol>
<li> The value of <code>ecb-compile-window</code> which contains the compile-window (if
there is one). Using the values of <code>ecb-compile-window-height</code>,
<code>ecb-windows-width</code>, <code>ecb-windows-height</code>.
</li></ol>

<p>Things <var>CREATE-CODE</var> must NOT do:
</p><ol>
<li> Splitting the edit-window
</li><li> Creating a compile-window
</li><li> Deleting the edit-window, the compile-window (if there is any) or the
ECB-windows-column(s)/row (see Precondition 1.)
</li><li> Referring to the value of <code>ecb-edit-window</code> because this is always nil
during <var>CREATE-CODE</var>.
</li></ol>

<p>Postconditions for <var>CREATE-CODE</var>:
</p><ol>
<li> The edit-window must be the selected window and must not be dedicated
and not be splitted.

</li><li> Every window besides the edit-window (and the compile-window) must be
a dedicated window (e.g. a ECB-tree-window).
</li></ol>
</dd></dl>

<p>Use this macro to program new layouts within your <samp>.emacs</samp> or any
other file which is loaded into your Emacs. After loading the file(s)
with all the new layout-definitions you can use it by customizing the
option <code>ecb-layout-name</code> to the appropriate name or with the
command <code>ecb-change-layout</code>.
</p>
<p>With the function <code>ecb-layout-undefine</code> you can remove a layout
from the list of available layouts:
</p>
<dl>
<dt><a name="index-layout_002dundefine"></a>Function: <strong>layout-undefine</strong> <em>name</em></dt>
<dd><p>Unbind ecb-layout-function-&lt;NAME&gt; and
ecb-delete-window-ecb-windows-&lt;NAME&gt; and remove <code>NAME</code> from
<code>ecb-available-layouts</code>.
</p></dd></dl>

<p>Here is an example for a new layout programmed with
<code>ecb-layout-define</code>:
</p>
<div class="example">
<pre class="example">(ecb-layout-define &quot;my-own-layout&quot; left nil
  ;; The frame is already splitted side-by-side and point stays in the
  ;; left window (= the ECB-tree-window-column)

  ;; Here is the creation code for the new layout
  
  ;; 1. Defining the current window/buffer as ECB-methods buffer
  (ecb-set-methods-buffer)
  ;; 2. Splitting the ECB-tree-windows-column in two windows
  (ecb-split-ver 0.75 t)
  ;; 3. Go to the second window
  (other-window 1)
  ;; 4. Defining the current window/buffer as ECB-history buffer
  (ecb-set-history-buffer)
  ;; 5. Make the ECB-edit-window current (see Postcondition above)
  (select-window (next-window)))
</pre></div>

<p>This layout definition defines a layout with name &ldquo;my-own-layout&rdquo;
which looks like:
</p>
<div class="example">
<pre class="example">-------------------------------------------------------
|              |                                      |
|              |                                      |
|              |                                      |
|  Methods     |                                      |
|              |                                      |
|              |                                      |
|              |               Edit                   |
|              |                                      |
|              |                                      |
|--------------|                                      |
|              |                                      |
|  History     |                                      |
|              |                                      |
-------------------------------------------------------
|                                                     |
|                    Compilation                      |
|                                                     |
-------------------------------------------------------
</pre></div>

<hr>
<div class="header">
<p>
Next: <a href="Programming-special-windows.html#Programming-special-windows" accesskey="n" rel="next">Programming special windows</a>, Previous: <a href="The-layout_002dengine.html#The-layout_002dengine" accesskey="p" rel="prev">The layout-engine</a>, Up: <a href="The-layout_002dengine.html#The-layout_002dengine" accesskey="u" rel="up">The layout-engine</a> &nbsp; [<a href="Concept-Index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Command-Index.html#Command-Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
